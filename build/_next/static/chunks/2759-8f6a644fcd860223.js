"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2759],{11962:function(e,t,i){i.d(t,{C:function(){return c}});var n=i(88944),a=i(52983),s=i(86228),o=i(2825),r=i(36346);function c(e){let{capability:t,method:i}=e,[c,h]=(0,a.useState)(),[p,d]=(0,a.useState)(!1),[l,u]=(0,a.useState)(),{address:m,isConnected:w}=(0,r.Tj)(),{chain:C,connector:g}=(0,n.m)(),f=(0,a.useMemo)(()=>l&&t?(0,s.uv)(t,l):[],[l,t]),N=(0,a.useMemo)(()=>f.map(e=>e.chainName).join(", "),[f]),y=(0,a.useMemo)(()=>f.find(e=>e.chainId===Number(null==C?void 0:C.id)),[f,C]);async function I(e,t,i){var n;let a=await (null===(n=t.getProvider)||void 0===n?void 0:n.call(t,{chainId:i.id}));if(a instanceof o.Sd){let e=await a.getCapabilities();h(a),u(e)}else a&&(h(a),u((0,s.Jt)(e,a)))}return(0,a.useEffect)(()=>{w&&g&&m&&C&&I(m,g,C)},[g,m,C,w]),(0,a.useEffect)(()=>{var e,t,n,a;d(c instanceof o.Sd?Object.values(s.mE).concat(Object.values(s.nf)).includes(i):!!(null==c?void 0:null===(a=c.session)||void 0===a?void 0:null===(n=a.namespaces)||void 0===n?void 0:null===(t=n.eip155)||void 0===t?void 0:null===(e=t.methods)||void 0===e?void 0:e.includes(i)))},[c]),{provider:c,currentChainsInfo:y,availableCapabilities:l,supportedChains:f,supportedChainsName:N,supported:p}}},50554:function(e,t,i){i.d(t,{L:function(){return a},M:function(){return n}});let n=[{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"purchase",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"donutBalances",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"check",type:"address"}],name:"getBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"}],a="0xfcfCFD8D9f4A23D8DD11b03b212B69262A3ba1b8"},86228:function(e,t,i){i.d(t,{mE:function(){return c},nf:function(){return h},ec:function(){return p},EZ:function(){return u},uv:function(){return d},Jt:function(){return l}});var n=i(93202);function a(e){return Object.values(n).find(t=>t.id===e)}var s=i(90398),o=i(36434),r=i(2825);let c={WALLET_GET_CAPABILITIES:"wallet_getCapabilities",WALLET_GET_CALLS_STATUS:"wallet_getCallsStatus",WALLET_SEND_CALLS:"wallet_sendCalls"},h={WALLET_GRANT_PERMISSIONS:"wallet_grantPermissions"},p={ATOMIC_BATCH:"atomicBatch",PAYMASTER_SERVICE:"paymasterService",PERMISSIONS:"permissions"};function d(e,t){return Object.keys(t).filter(i=>{var n;let a=t[i];return(null==a?void 0:null===(n=a[e])||void 0===n?void 0:n.supported)===!0}).map(e=>{var t;let i=(0,o.H_)(e,"number"),n=a(i);return{chainId:i,chainName:null!==(t=null==n?void 0:n.name)&&void 0!==t?t:"Unknown Chain(".concat(i,")")}})}function l(e,t){var i,n;let a=null==t?void 0:null===(n=t.session)||void 0===n?void 0:null===(i=n.sessionProperties)||void 0===i?void 0:i.capabilities;if(!a)return;let o=(0,s.R)(a)[e];if(o)return Object.fromEntries(Object.entries(o).map(e=>{let[t,i]=e;return[parseInt(t,16),i]}))}async function u(e,t,i){if(t instanceof r.Sd)return Object.entries(await t.getCapabilities()).map(e=>{var t;let[i]=e,n=a((0,o.H_)(i,"number"));return{chainId:(0,o.H_)(i,"number"),chainName:null!==(t=null==n?void 0:n.name)&&void 0!==t?t:"Unknown Chain (".concat(i,")")}});let n=l(i,t);return n?d(e,n):[]}},34343:function(e,t,i){i.d(t,{Ks:function(){return Q}}),i(34165);var n=i(75542),a=i(73284),s=i(50007),o=i(91824),r=i(16435),c=i(16831),h=i(51392),p=i(77910),d=i(34159),l=i(30891),u=i(22533),m=i(29153),w=i(93919),C=i(50909),g=i(79323),f=i(43695),N=i(55899),y=i(81619),I=i(15653),v=i(26811),E=i(30817),A=i(26725),b=i(98881),k=i(20496),T=i(14691),_=i(10835),K=i(35371),P=i(74652);i(36203);var R=i(15333),O=i(24553);async function S(e){if(!e)throw Error("networkControllerClient:getApprovedCaipNetworks - connector is undefined");let t=await e?.getProvider(),i=t?.session?.namespaces,n=[];return i&&Object.keys(i).forEach(e=>{let t=i?.[e]?.chains;t&&n.push(...t)}),{supportsAllNetworks:!0,approvedCaipNetworkIds:n}}function D(e){if(!e)throw Error("No CAIP address provided");let t=e.split(":")[2];if(!t)throw Error("Invalid CAIP address");return t}function L(e){return e.map(e=>({blockExplorers:{default:{apiUrl:"",name:"",url:e.explorerUrl||""}},fees:void 0,formatters:void 0,id:Number(e.chainId),name:e.name,nativeCurrency:{decimals:18,name:e.currency,symbol:e.currency},rpcUrls:{default:{http:[e.rpcUrl]}},serializers:void 0}))}var U=i(2825),q=i(76401),M=i(88545),W=i(6373),j=i(7015),x=i(51856),$=i(71780),H=i(76950),B=i(24523);function G(e,t){let i,n,a,s,o,r,c,h;let p=e.isNewChainsStale??!0;return(0,M.K)(d=>({id:"walletConnect",name:"WalletConnect",type:G.type,async setup(){let e=await this.getProvider().catch(()=>null);e&&(o||(o=this.onConnect.bind(this),e.on("connect",o)),c||(c=this.onSessionDelete.bind(this),e.on("session_delete",c)))},async connect({...t}={}){try{let i=await this.getProvider();if(!i)throw new W.M;r||(r=this.onDisplayUri,i.on("display_uri",r));let n=await this.isChainsStale();if(i.session&&n&&await i.disconnect(),!i.session||n){let n=B.sQ.createNamespaces(e.networks);await i.connect({optionalNamespaces:n,..."pairingTopic"in t?{pairingTopic:t.pairingTopic}:{}}),this.setRequestedChainsIds(e.networks.map(e=>Number(e.chainId)))}let p=(await i.enable()).map(e=>(0,x.K)(e)),d=await this.getChainId();return r&&(i.removeListener("display_uri",r),r=void 0),o&&(i.removeListener("connect",o),o=void 0),a||(a=this.onAccountsChanged.bind(this),i.on("accountsChanged",a)),s||(s=this.onChainChanged.bind(this),i.on("chainChanged",s)),h||(h=this.onDisconnect.bind(this),i.on("disconnect",h)),c||(c=this.onSessionDelete.bind(this),i.on("session_delete",c)),{accounts:p,chainId:d}}catch(e){if(/(user rejected|connection request reset)/i.test(e?.message))throw new $.ab(e);throw e}},async disconnect(){let e=await this.getProvider();try{await e?.disconnect()}catch(e){if(!/No matching key/i.test(e.message))throw e}finally{s&&(e?.removeListener("chainChanged",s),s=void 0),h&&(e?.removeListener("disconnect",h),h=void 0),o||(o=this.onConnect.bind(this),e?.on("connect",o)),a&&(e?.removeListener("accountsChanged",a),a=void 0),c&&(e?.removeListener("session_delete",c),c=void 0),this.setRequestedChainsIds([])}},async getAccounts(){let e=await this.getProvider();if(!e?.session?.namespaces)return[];let t=e?.session?.namespaces.eip155?.accounts;return t?.map(e=>e.split(":")[2])??[]},async getProvider({chainId:a}={}){async function s(){if(!e.networks.map(e=>Number(e.chainId)).length)return;let i=t.universalAdapter?.getWalletConnectProvider();if(!i)throw Error("Provider not found");return i}i||(n||(n=s()),i=await n,i?.events.setMaxListeners(Number.POSITIVE_INFINITY));let o=t.getCaipNetwork()?.chainId;if(a&&o!==a){let e=E.MO.getStoredActiveCaipNetwork();e&&"eip155"===e.chainNamespace?await this.switchChain?.({chainId:Number(e.chainId)}):await this.switchChain?.({chainId:a})}return i},async getChainId(){let i=t.getCaipNetwork()?.chainId;if(i)return i;let n=await this.getProvider(),a=n.session?.namespaces.eip155?.chains?.[0],s=e.networks.find(e=>e.id===a);return s?.chainId},async isAuthorized(){try{let[e,t]=await Promise.all([this.getAccounts(),this.getProvider()]);if(!e.length)return!1;if(await this.isChainsStale()&&t.session)return await t.disconnect().catch(()=>{}),!1;return!0}catch{return!1}},async switchChain({addEthereumChainParameter:t,chainId:i}){let n=await this.getProvider();if(!n)throw new W.M;let a=e.networks.find(e=>e.chainId===i),[s]=a?L([a]):[];if(!s)throw new $.x3(new j.X4);try{a?.id&&n.setDefaultChain(a?.id),await n.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,H.eC)(i)}]}),d.emitter.emit("change",{chainId:Number(i)});let e=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...e,i]),s}catch(e){if(/(?:user rejected)/iu.test(e.message))throw new $.ab(e);try{let e={blockExplorerUrls:t?.blockExplorerUrls?t.blockExplorerUrls:s.blockExplorers?.default.url?[s.blockExplorers?.default.url]:[],chainId:(0,H.eC)(i),chainName:s.name,iconUrls:t?.iconUrls,nativeCurrency:s.nativeCurrency,rpcUrls:s.rpcUrls.default.http};await n.request({method:"wallet_addEthereumChain",params:[e]});let a=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...a,i]),s}catch(e){throw new $.ab(e)}}},onAccountsChanged(e){0===e.length?this.onDisconnect():d.emitter.emit("change",{accounts:e.map(e=>(0,x.K)(e))})},onChainChanged(e){let t=Number(e);d.emitter.emit("change",{chainId:t})},async onConnect(e){let t=Number(e.chainId),i=await this.getAccounts();d.emitter.emit("connect",{accounts:i,chainId:t})},async onDisconnect(e){this.setRequestedChainsIds([]),d.emitter.emit("disconnect");let t=await this.getProvider();a&&(t.removeListener("accountsChanged",a),a=void 0),s&&(t.removeListener("chainChanged",s),s=void 0),h&&(t.removeListener("disconnect",h),h=void 0),c&&(t.removeListener("session_delete",c),c=void 0),o||(o=this.onConnect.bind(this),t.on("connect",o))},onDisplayUri(e){d.emitter.emit("message",{type:"display_uri",data:e})},onSessionDelete(){this.onDisconnect()},getNamespaceChainsIds(){if(!i?.session?.namespaces)return[];let e=i?.session?.namespaces.eip155?.accounts;return e?.map(e=>Number.parseInt(e.split(":")[1]??""))??[]},async getRequestedChainsIds(){return[...new Set(await d.storage?.getItem(this.requestedChainsStorageKey)??[])]},async isChainsStale(){if(!p)return!1;let e=d.chains.map(e=>e.id),t=this.getNamespaceChainsIds();if(t.length&&!t.some(t=>e.includes(t)))return!1;let i=await this.getRequestedChainsIds();return!e.every(e=>i.includes(Number(e)))},async setRequestedChainsIds(e){await d.storage?.setItem(this.requestedChainsStorageKey,e)},get requestedChainsStorageKey(){return`${this.id}.requestedChains`}}))}G.type="walletConnect";var F=i(35024),J=i(11594),z=i(76394);let V=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"];class Q{constructor(e){this.appKit=void 0,this.options=void 0,this.chainNamespace=P.bq.CHAIN.EVM,this.defaultCaipNetwork=void 0,this.tokens=K.gk.getCaipTokens(this.options?.tokens),this.siweControllerClient=this.options?.siweConfig,this.adapterType="wagmi",this.caipNetworks=e.networks.map(t=>({...t,rpcUrl:P.fZ.extendRpcUrlWithProjectId(t.rpcUrl,e.projectId)})),this.wagmiChains=L(this.caipNetworks.filter(e=>e.chainNamespace===P.bq.CHAIN.EVM));let t=Object.fromEntries(this.wagmiChains.map(t=>[t.id,function({chain:e,projectId:t}){let i=E.j1.getBlockchainApiUrl(),n=e.rpcUrls[0]?.http?.[0];return K.CK.WalletConnectRpcChainIds.includes(e.id)?(0,O.t)([(0,R.d)(`${i}/v1/?chainId=${K.bq.EIP155}:${e.id}&projectId=${t}`,{fetchOptions:{headers:{"Content-Type":"text/plain"}}}),(0,R.d)(n)]):(0,R.d)(n)}({chain:t,projectId:e.projectId})])),i=[...e.connectors??[]];this.wagmiConfig=(0,n._)({...this.createConfigParams,chains:this.wagmiChains,transports:t,connectors:[...i,...this.createConfigParams?.connectors??[]]})}setCustomConnectors(e,t){let i=[];!1!==e.enableWalletConnect&&i.push(G(e,t)),!1!==e.enableInjected&&i.push((0,a.L)({shimDisconnect:!0})),!1!==e.enableCoinbase&&i.push((0,F.D)({version:"4",appName:e.metadata?.name??"Unknown",appLogoUrl:e.metadata?.icons[0]??"Unknown",preference:e.coinbasePreference??"all"}));let n=e.features?.email===void 0?E.bq.DEFAULT_FEATURES.email:e.features?.email,s=e.features?.socials?e.features?.socials?.length>0:E.bq.DEFAULT_FEATURES.socials;(n||s)&&i.push(function(e){function t(e){return P.p1.parseEvmChainId(e)||1}return(0,M.K)(i=>({id:K.bq.AUTH_CONNECTOR_ID,name:"AppKit Auth",type:"w3mAuth",chain:P.bq.CHAIN.EVM,async connect(e={}){let i=await this.getProvider(),n=e.chainId;if(e.isReconnecting&&!(n=i.getLastUsedChainId()))throw Error("ChainId not found in provider");let{address:a,chainId:s}=await i.connect({chainId:n});await i.getSmartAccountEnabledNetworks();let o=t(s);return{accounts:[a],account:a,chainId:o,chain:{id:o,unsuported:!1}}},async disconnect(){let e=await this.getProvider();await e.disconnect()},async getAccounts(){let e=await this.getProvider(),{address:t}=await e.connect();return i.emitter.emit("change",{accounts:[t]}),[t]},async getProvider(){return this.provider||(this.provider=J.D.getInstance(e.options.projectId)),Promise.resolve(this.provider)},async getChainId(){let e=await this.getProvider(),{chainId:i}=await e.getChainId();return t(i)},async isAuthorized(){let e=await this.getProvider(),{isConnected:t}=await e.isConnected();return t},async switchChain({chainId:e}){try{let t=i.chains.find(t=>t.id===e);if(!t)throw new $.x3(Error("chain not found on connector."));let n=await this.getProvider(),a=await n.connect({chainId:e});return i.emitter.emit("change",{chainId:Number(e),accounts:[a.address]}),t}catch(e){if(e instanceof Error)throw new $.x3(e);throw e}},onAccountsChanged(e){0===e.length?this.onDisconnect():i.emitter.emit("change",{accounts:e.map(x.K)})},onChainChanged(e){let t=Number(e);i.emitter.emit("change",{chainId:t})},async onDisconnect(e){let t=await this.getProvider();await t.disconnect()}}))}({chains:this.wagmiChains,options:{projectId:e.projectId}})),i.forEach(e=>{let t=this.wagmiConfig._internal.connectors.setup(e);this.wagmiConfig._internal.connectors.setState(e=>[...e,t])})}construct(e,t){if(!t.projectId)throw Error("appkit:initialize - projectId is undefined");if(this.appKit=e,this.options=t,this.caipNetworks=t.networks,this.defaultCaipNetwork=t.defaultNetwork||t.networks[0],this.tokens=K.gk.getCaipTokens(t.tokens),this.setCustomConnectors(t,e),!this.wagmiConfig)throw Error("appkit:wagmiConfig - is undefined");this.networkControllerClient={switchCaipNetwork:async e=>{let t=Number(P.p1.caipNetworkIdToNumber(e?.id));t&&this.wagmiConfig&&await (0,s.c)(this.wagmiConfig,{chainId:t})},getApprovedCaipNetworksData:async()=>{if(!this.wagmiConfig)throw Error("networkControllerClient:getApprovedCaipNetworksData - wagmiConfig is undefined");return new Promise(e=>{let t=new Map(this.wagmiConfig.state.connections).get(this.wagmiConfig.state.current||"");t?.connector?.id===K.bq.AUTH_CONNECTOR_ID?e({supportsAllNetworks:!0,approvedCaipNetworkIds:K.CK.WalletConnectRpcChainIds.map(e=>`${K.bq.EIP155}:${e}`)}):t?.connector?.id===K.bq.WALLET_CONNECT_CONNECTOR_ID&&e(S(this.wagmiConfig.connectors.find(e=>e.id===K.bq.WALLET_CONNECT_CONNECTOR_ID))),e({approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})})}},this.connectionControllerClient={connectWalletConnect:async()=>{if(!this.wagmiConfig)throw Error("connectionControllerClient:getWalletConnectUri - wagmiConfig is undefined");let e=this.wagmiConfig.connectors.find(e=>e.id===K.bq.WALLET_CONNECT_CONNECTOR_ID);if(!e)throw Error("connectionControllerClient:getWalletConnectUri - connector is undefined");let t=await e.getProvider(),n=await this.options?.siweConfig?.getMessageParams?.(),a=this.options?.siweConfig?.options?.enabled,s="function"==typeof t?.authenticate,r=n&&Object.keys(n||{}).length>0,c=this.options?.siweConfig;if(a&&s&&r&&c){await e.setRequestedChainsIds(n.chains);let{SIWEController:a,getDidChainId:s,getDidAddress:o}=await i.e(368).then(i.bind(i,50368)),r=this.caipNetworks?.filter(e=>"eip155"===e.chainNamespace).map(e=>e.id);n.chains=this.caipNetworks?.filter(e=>"eip155"===e.chainNamespace).map(e=>e.chainId);let h=await t.authenticate({nonce:await c.getNonce(),methods:[...V],...n,chains:r}),p=h?.auths?.[0];if(p){let{p:e,s:i}=p,n=s(e.iss),r=o(e.iss);r&&n&&a.setSession({address:r,chainId:parseInt(n,10)});try{let n=t.client.formatAuthMessage({request:e,iss:e.iss});await a.verifyMessage({message:n,signature:i.s,cacao:p})}catch(e){throw console.error("Error verifying message",e),await t.disconnect().catch(console.error),await a.signOut().catch(console.error),e}}}let h=Number(P.p1.caipNetworkIdToNumber(this.appKit?.getCaipNetwork()?.id));await (0,o.$)(this.wagmiConfig,{connector:e,chainId:h})},connectExternal:async({id:e,provider:t,info:i})=>{if(!this.wagmiConfig)throw Error("networkControllerClient:getApprovedCaipNetworksData - wagmiConfig is undefined");let n=this.wagmiConfig.connectors.find(t=>t.id===e);if(!n)throw Error("connectionControllerClient:connectExternal - connector is undefined");this.appKit?.setClientId(null),t&&i&&n.id===K.bq.EIP6963_CONNECTOR_ID&&n.setEip6963Wallet?.({provider:t,info:i});let a=Number(P.p1.caipNetworkIdToNumber(this.appKit?.getCaipNetwork()?.id));await (0,o.$)(this.wagmiConfig,{connector:n,chainId:a})},checkInstalled:e=>{let t=this.appKit?.getConnectors().find(e=>"INJECTED"===e.type);return e?!!t&&!!window?.ethereum&&e.some(e=>!!window.ethereum?.[String(e)]):!!window.ethereum},disconnect:async()=>{if(await (0,r.z)(this.wagmiConfig),this.options?.siweConfig?.options?.signOutOnDisconnect){let{SIWEController:e}=await i.e(368).then(i.bind(i,50368));await e.signOut()}P.mr.removeItem(P.uJ.WALLET_ID),P.mr.removeItem(P.uJ.CONNECTED_CONNECTOR),P.mr.removeItem(P.uJ.WALLET_NAME),this.appKit?.setClientId(null),this.syncAccount({address:void 0,chainId:void 0,connector:void 0,addresses:void 0,status:"disconnected"}),this.appKit?.resetAccount("solana")},signMessage:async e=>{let t=D(this.appKit?.getCaipAddress()||"");return(0,c.l)(this.wagmiConfig,{message:e,account:t})},estimateGas:async e=>{if(e.chainNamespace&&"eip155"!==e.chainNamespace)throw Error(`Invalid chain namespace - Expected eip155, got ${e.chainNamespace}`);try{return await (0,h.Q)(this.wagmiConfig,{account:e.address,to:e.to,data:e.data,type:"legacy"})}catch(e){return BigInt(0)}},sendTransaction:async e=>{if(e.chainNamespace&&"eip155"!==e.chainNamespace)throw Error(`Invalid chain namespace - Expected eip155, got ${e.chainNamespace}`);let{chainId:t}=(0,p.D)(this.wagmiConfig),i={account:e.address,to:e.to,value:e.value,gas:e.gas,gasPrice:e.gasPrice,data:e.data,chainId:t,type:"legacy"};await (0,A.Z)(this.wagmiConfig,i);let n=await (0,b.T)(this.wagmiConfig,i);return await (0,d.e)(this.wagmiConfig,{hash:n,timeout:25e3}),n},writeContract:async e=>{let t=D(this.appKit?.getCaipAddress()||""),i=Number(P.p1.caipNetworkIdToNumber(this.appKit?.getCaipNetwork()?.id));return await (0,l.n)(this.wagmiConfig,{chain:this.wagmiChains?.[i],chainId:i,address:e.tokenAddress,account:t,abi:e.abi,functionName:e.method,args:[e.receiverAddress,e.tokenAmount]})},getEnsAddress:async e=>{try{if(!this.wagmiConfig)throw Error("networkControllerClient:getApprovedCaipNetworksData - wagmiConfig is undefined");let t=Number(P.p1.caipNetworkIdToNumber(this.appKit?.getCaipNetwork()?.id)),i=!1,n=!1;return(0,P.oL)(e)&&(n=await this.appKit?.resolveReownName(e)||!1),1===t&&(i=await (0,u.O)(this.wagmiConfig,{name:(0,q.F)(e),chainId:t})),i||n||!1}catch{return!1}},getEnsAvatar:async e=>{let t=Number(P.p1.caipNetworkIdToNumber(this.appKit?.getCaipNetwork()?.id));return t===k.R.id&&(await (0,m.r)(this.wagmiConfig,{name:(0,q.F)(e),chainId:t})||!1)},parseUnits:T.v,formatUnits:_.b},E.RY.state.chains.set(this.chainNamespace,{chainNamespace:this.chainNamespace,connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient,adapterType:this.adapterType,caipNetworks:this.caipNetworks}),this.syncConnectors(this.wagmiConfig.connectors),this.syncAuthConnector(this.wagmiConfig?.connectors.find(e=>e.id===K.bq.AUTH_CONNECTOR_ID)),this.syncRequestedNetworks(this.caipNetworks),(0,w.f)(this.wagmiConfig,{onChange:e=>{this.syncConnectors(e),this.syncAuthConnector(e.find(e=>e.id===K.bq.AUTH_CONNECTOR_ID))}}),(0,C.u)(this.wagmiConfig,{onChange:e=>{this.syncAccount(e)}}),this.appKit?.setEIP6963Enabled(!1!==t.enableEIP6963),this.appKit?.subscribeShouldUpdateToAddress(e=>{if(e){let t=g.E(this.wagmiConfig),i=t[0]?.connector;i&&f.y(this.wagmiConfig,{connector:i}).then(t=>this.syncAccount({address:e,isConnected:!0,addresses:t.accounts,connector:i,chainId:t.chainId,status:"connected"}))}})}subscribeState(e){return this.appKit?.subscribeState(t=>e({...t,selectedNetworkId:Number(P.p1.caipNetworkIdToNumber(t.selectedNetworkId))}))}syncRequestedNetworks(e){Array.from(new Set(e.map(e=>e.chainNamespace))).filter(e=>!!e).forEach(t=>{this.appKit?.setRequestedCaipNetworks(e.filter(e=>e.chainNamespace===t),t)})}async syncAccount({address:e,chainId:t,connector:i,addresses:n,status:a}){let s=E.RY.state.activeCaipAddress;if("disconnected"===a&&!s){this.appKit?.resetAccount(this.chainNamespace),this.appKit?.resetWcConnection(),this.appKit?.resetNetwork(),this.appKit?.setAllAccounts([],this.chainNamespace),P.mr.removeItem(P.uJ.WALLET_ID);return}if(this.wagmiConfig&&i){if(i&&"WalletConnect"===i.name&&i.getProvider&&e){let n=t||Number(P.p1.caipNetworkIdToNumber(this.appKit?.getCaipNetwork()?.id)),a=await i.getProvider(),s=a?.session?.namespaces||{},o=s?Object.keys(s):[],r=this.appKit?.getPreferredAccountType();o.forEach(e=>{let t=s?.[e]?.accounts[0];z.h.setProvider(e,a),z.h.setProviderId(e,"walletConnect"),this.appKit?.setPreferredAccountType(r,e),this.appKit?.setCaipAddress(t,e)}),this.appKit?.getCaipNetwork()?.chainNamespace!=="solana"&&(this.syncNetwork(e,n,!0),await Promise.all([this.syncProfile(e,n),this.syncBalance(e,n),this.syncConnectedWalletInfo(i),this.appKit?.setApprovedCaipNetworksData(this.chainNamespace)]))}else if("connected"===a&&e&&t){let a=`eip155:${t}:${e}`;this.syncNetwork(e,t,!0),this.appKit?.setCaipAddress(a,this.chainNamespace),await Promise.all([this.syncProfile(e,t),this.syncBalance(e,t),this.syncConnectedWalletInfo(i),this.appKit?.setApprovedCaipNetworksData(this.chainNamespace)]),i&&this.syncConnectedWalletInfo(i),i?.id!==K.bq.AUTH_CONNECTOR_ID&&n?.length&&this.appKit?.setAllAccounts(n.map(e=>({address:e,type:"eoa"})),this.chainNamespace)}else if("reconnecting"===a){this.appKit?.setLoading(!0);let e=(0,N.C)(this.wagmiConfig).find(e=>e.id===i.id);e&&(await (0,y.G)(this.wagmiConfig,{connectors:[e]}),this.appKit?.setLoading(!1))}}}async syncNetwork(e,t,i){let n=this.caipNetworks.find(e=>e.chainId===t);if(n&&t&&(this.appKit?.setCaipNetwork({chainId:n.chainId,id:n.id,name:n.name||"",imageId:K.CK.NetworkImageIds[n.chainId],imageUrl:this.options?.chainImages?.[n.chainId],chainNamespace:this.chainNamespace,currency:n?.currency||"",explorerUrl:n?.explorerUrl||"",rpcUrl:n?.rpcUrl||""}),i&&e&&t)){let i=`eip155:${t}:${e}`;if(this.appKit?.setCaipAddress(i,this.chainNamespace),n?.explorerUrl){let t=`${n.explorerUrl}/address/${e}`;this.appKit?.setAddressExplorerUrl(t,this.chainNamespace)}else this.appKit?.setAddressExplorerUrl(void 0,this.chainNamespace);await this.syncBalance(e,t)}}async syncReownName(e){if(!this.appKit)throw Error("syncReownName - appKit is undefined");try{let t=await this.appKit.getReownName(e);if(t[0]){let e=t[0];this.appKit?.setProfileName(e.name,this.chainNamespace)}else this.appKit?.setProfileName(null,this.chainNamespace)}catch{this.appKit?.setProfileName(null,this.chainNamespace)}}async syncProfile(e,t){if(!this.appKit)throw Error("syncProfile - appKit is undefined");try{let{name:t,avatar:i}=await this.appKit.fetchIdentity({address:e});this.appKit?.setProfileName(t,this.chainNamespace),this.appKit?.setProfileImage(i,this.chainNamespace),t||await this.syncReownName(e)}catch{if(t===k.R.id){let i=await (0,I.w)(this.wagmiConfig,{address:e,chainId:t});if(i){this.appKit?.setProfileName(i,this.chainNamespace);let e=await (0,m.r)(this.wagmiConfig,{name:i,chainId:t});e&&this.appKit?.setProfileImage(e,this.chainNamespace)}else await this.syncReownName(e),this.appKit?.setProfileImage(null,this.chainNamespace)}else await this.syncReownName(e),this.appKit?.setProfileImage(null,this.chainNamespace)}}async syncBalance(e,t){let i=this.caipNetworks.find(e=>e.chainId===t);if(i&&this.wagmiConfig){let n=await (0,v.s)(this.wagmiConfig,{address:e,chainId:t,token:this.options?.tokens?.[i.id]?.address});this.appKit?.setBalance(n.formatted,n.symbol,this.chainNamespace);return}this.appKit?.setBalance(void 0,void 0,this.chainNamespace)}async syncConnectedWalletInfo(e){if(!e)throw Error("syncConnectedWalletInfo - connector is undefined");if(e.id===K.bq.WALLET_CONNECT_CONNECTOR_ID&&e.getProvider){let t=await e.getProvider();t.session&&this.appKit?.setConnectedWalletInfo({...t.session.peer.metadata,name:t.session.peer.metadata.name,icon:t.session.peer.metadata.icons?.[0]},this.chainNamespace)}else{let t=this.appKit?.getConnectors().find(t=>t.id===e.id);this.appKit?.setConnectedWalletInfo({name:e.name,icon:e.icon||this.appKit.getConnectorImage(t)},this.chainNamespace)}}syncConnectors(e){let t=e.map(e=>({...e,chain:this.chainNamespace})),i=new Set,n=t.filter(e=>{let t=i.has(e.id);return i.add(e.id),!t}),a=[];n.forEach(({id:e,name:t,type:i,icon:n})=>{K.bq.AUTH_CONNECTOR_ID!==e&&a.push({id:e,explorerId:K.CK.ConnectorExplorerIds[e],imageUrl:this.options?.connectorImages?.[e]??n,name:K.CK.ConnectorNamesMap[e]??t,imageId:K.CK.ConnectorImageIds[e],type:K.CK.ConnectorTypesMap[i]??"EXTERNAL",info:{rdns:e},chain:this.chainNamespace})}),this.appKit?.setConnectors(a)}async syncAuthConnector(e){if(e){let t=await e.getProvider();this.appKit?.addConnector({id:K.bq.AUTH_CONNECTOR_ID,type:"AUTH",name:"w3mAuth",provider:t,chain:this.chainNamespace}),this.initAuthConnectorListeners(e)}}async initAuthConnectorListeners(e){e&&(await this.listenAuthConnector(e),await this.listenModal(e))}async listenAuthConnector(e,t=!1){if(t||"undefined"!=typeof window&&e){this.appKit?.setLoading(!0);let t=await e.getProvider(),i=t.getLoginEmailUsed();this.appKit?.setLoading(i),t.onRpcRequest(e=>{U.$D.checkIfRequestExists(e)?U.$D.checkIfRequestIsSafe(e)||this.appKit?.handleUnsafeRPCRequest():(this.appKit?.open(),console.error(U.y_.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:e.method}),setTimeout(()=>{this.appKit?.showErrorMessage(U.y_.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),t.rejectRpcRequests())}),t.onRpcError(()=>{this.appKit?.isOpen()&&(this.appKit?.isTransactionStackEmpty()?this.appKit?.close():this.appKit?.popTransactionStack(!0))}),t.onRpcSuccess((e,t)=>{U.$D.checkIfRequestIsSafe(t)||(this.appKit?.isTransactionStackEmpty()?this.appKit?.close():this.appKit?.popTransactionStack())}),t.onNotConnected(()=>{let e=this.appKit?.getIsConnectedState(),t=P.mr.getItem(P.uJ.CONNECTED_CONNECTOR);e||"AUTH"!==t||(this.appKit?.setCaipAddress(void 0,this.chainNamespace),this.appKit?.setLoading(!1))}),t.onIsConnected(()=>{t.connect()}),t.onConnect(e=>{let t=`eip155:${e.chainId}:${e.address}`;this.appKit?.setCaipAddress(t,this.chainNamespace),this.appKit?.setSmartAccountDeployed(!!e.smartAccountDeployed,this.chainNamespace),this.appKit?.setPreferredAccountType(e.preferredAccountType,this.chainNamespace),this.appKit?.setAllAccounts(e.accounts||[{address:e.address,type:e.preferredAccountType||"eoa"}],this.chainNamespace),E.MO.setConnectedConnector("AUTH"),this.appKit?.setLoading(!1)}),t.onGetSmartAccountEnabledNetworks(e=>{this.appKit?.setSmartAccountEnabledNetworks(e,this.chainNamespace)}),t.onSetPreferredAccount(({address:t,type:i})=>{t&&(this.appKit?.setPreferredAccountType(i,this.chainNamespace),this.wagmiConfig&&(0,y.G)(this.wagmiConfig,{connectors:[e]}))})}}async listenModal(e){let t=await e.getProvider();this.subscribeState(e=>{e.open||t.rejectRpcRequests()})}}},11594:function(e,t,i){i.d(t,{D:function(){return a}});var n=i(2825);class a{constructor(){}static getInstance(e,t){return a.instance||(a.instance=new n.Sd(e,t)),a.instance}}},24523:function(e,t,i){i.d(t,{Tz:function(){return n.T},sQ:function(){return n.s}}),i(44606),i(21370),i(30817),i(64010);var n=i(34556)},76394:function(e,t,i){i.d(t,{h:function(){return n.h}});var n=i(95319)}}]);